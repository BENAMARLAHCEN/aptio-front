<div class="space-y-4">
  <!-- Date Navigation -->
  <div class="flex items-center justify-between bg-neutral-light p-3 rounded-lg">
    <button
      (click)="onDateChange(-1)"
      class="p-1 rounded-full text-neutral-dark hover:bg-white focus:outline-none"
      title="Previous Day">
      <span class="material-icons-outlined">chevron_left</span>
    </button>

    <div class="flex items-center">
      <span class="material-icons-outlined mr-2 text-primary">calendar_today</span>
      <span class="font-medium">{{ formatDateForDisplay(selectedDate) }}</span>
      <button class="ml-2 p-1 rounded-full text-neutral-dark hover:bg-white focus:outline-none" title="Select Date">
        <span class="material-icons-outlined">event</span>
      </button>
    </div>

    <button
      (click)="onDateChange(1)"
      class="p-1 rounded-full text-neutral-dark hover:bg-white focus:outline-none"
      title="Next Day">
      <span class="material-icons-outlined">chevron_right</span>
    </button>
  </div>

  <!-- Resource Type Filters -->
  <div class="bg-neutral-light p-3 rounded-lg">
    <div class="flex flex-wrap items-center gap-2">
      <span class="text-sm font-medium text-neutral-dark">Resource Type:</span>

      <div *ngFor="let type of getUniqueResourceTypes()" class="flex items-center">
        <button
          (click)="toggleResourceTypeSelection(type)"
          class="flex items-center px-2 py-1 rounded-md text-sm"
          [class.bg-primary-light]="selectedResourceTypes.includes(type)"
          [class.text-primary]="selectedResourceTypes.includes(type)"
          [class.bg-white]="!selectedResourceTypes.includes(type)"
          [class.text-neutral-dark]="!selectedResourceTypes.includes(type)">
          {{ type }}
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center p-8">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="p-4 bg-red-100 border border-red-300 text-red-700 rounded-lg">
    {{ errorMessage }}
    <button (click)="loadResourceData()" class="ml-2 text-primary hover:underline">Try Again</button>
  </div>

  <!-- Resource Schedules -->
  <div *ngIf="!isLoading && !errorMessage" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
    <div *ngFor="let resourceSchedule of resourceSchedules" class="border border-neutral-light rounded-lg">
      <!-- Resource Header -->
      <div class="p-3 border-b border-neutral-light bg-neutral-light">
        <div class="flex justify-between items-center">
          <div class="font-medium">{{ resourceSchedule.resource.name }}</div>
          <div class="text-sm px-2 py-1 rounded-full" [style.background-color]="resourceSchedule.resource.color + '33'" [style.color]="resourceSchedule.resource.color">
            {{ resourceSchedule.resource.type }}
          </div>
        </div>
        <div class="text-xs text-neutral mt-1">
          Capacity: {{ resourceSchedule.resource.capacity }}
        </div>
      </div>

      <!-- Resource Schedule -->
      <div class="p-3">
        <!-- No Schedule Message -->
        <div *ngIf="resourceSchedule.entries.length === 0" class="text-center py-4 text-sm text-neutral">
          No bookings for this resource
        </div>

        <!-- Schedule Entries -->
        <div *ngIf="resourceSchedule.entries.length > 0" class="space-y-2">
          <div
            *ngFor="let entry of resourceSchedule.entries"
            class="p-2 rounded-lg cursor-pointer"
            [class]="getEntryTypeClass(entry.type)"
            (click)="viewAppointment(entry.id)">
            <div class="font-medium text-sm">{{ entry.title }}</div>
            <div class="text-xs">{{ formatTimeRange(entry.startTime, entry.endTime) }}</div>

            <!-- Staff info if available -->
            <div *ngIf="resourceSchedule.staff.get(entry.staffId)" class="flex items-center mt-1">
              <span
                class="w-2 h-2 rounded-full mr-1"
                [style.background-color]="getStaffColor(entry.staffId)">
              </span>
              <span class="text-xs">
                {{ resourceSchedule.staff.get(entry.staffId)?.firstName }}
                {{ resourceSchedule.staff.get(entry.staffId)?.lastName }}
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Resources Message -->
  <div *ngIf="!isLoading && !errorMessage && resourceSchedules.length === 0" class="text-center p-8">
    <div class="text-neutral">No resources found for the selected filter.</div>
  </div>

  <!-- Create Appointment Button -->
  <div class="fixed bottom-6 right-6">
    <button
      (click)="createAppointment()"
      class="bg-primary text-white rounded-full p-4 shadow-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2">
      <span class="material-icons-outlined">add</span>
    </button>
  </div>
</div>
